---
- name: Test wsl role absent state
  hosts: localhost
  gather_facts: true
  vars:
    wsl_user: testuser
    wsl_state: absent
    is_wsl: true
  tasks:
    - name: Mock WSL environment variables
      ansible.builtin.set_fact:
        os_family: Debian
        ansible_kernel: 'Linux 5.4.72-microsoft-standard-WSL2'
      tags: test

    - name: Include wsl role
      ansible.builtin.include_role:
        name: net.markfaine.wsl
      tags: test

    - name: Verify WSL role runs without critical errors
      ansible.builtin.debug:
        msg: 'WSL role absent state completed'
      tags: test
