---
- name: Test wsl role present state
  hosts: localhost
  gather_facts: true
  vars:
    wsl_user: testuser
    wsl_state: present
    is_wsl: true
  tasks:
    - name: Mock WSL environment variables
      ansible.builtin.set_fact:
        ansible_os_family: Debian
        ansible_kernel: 'Linux 5.4.72-microsoft-standard-WSL2'
      tags: test

    - name: Include wsl role
      ansible.builtin.include_role:
        name: net.markfaine.wsl
      tags: test

    - name: Verify WSL configuration file exists (if WSL environment)
      ansible.builtin.stat:
        path: /etc/wsl.conf
      register: wsl_conf_stat
      when: is_wsl | default(false)
      tags: test
